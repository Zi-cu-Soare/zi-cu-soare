function ZiCuSoare(){var t={apiKey:"AIzaSyD-C9LoYRZb5nudMJsRw-Rrei9YCWgvWBY",authDomain:"zi-cu-soare.firebaseapp.com",databaseURL:"https://zi-cu-soare.firebaseio.com",messagingSenderId:"227888148790"};firebase.initializeApp(t),this.initFirebase()}function slugifyAddress(){return window.location.pathname.toString().toLowerCase().trim().replace(/^\//,"").replace(/&/g,"-and-").replace(/[\s\W-]+/g,"-").replace(/[^a-zA-Z0-9-_]+/g,"")}function shake(t){$(t).css("color","red").animate({opacity:.5},50).animate({"margin-left":"+=10px"},100).animate({"margin-left":"-=10px"},100).animate({opacity:1},{duration:50,complete:function(){$(this).css("color","black")}})}ZiCuSoare.prototype.initFirebase=function(){this.addr=slugifyAddress(),this.auth=firebase.auth(),this.db=firebase.database(),this.re_db=this.db.ref().child("reactions"),this.re_db.on("value",this.listReactions.bind(this)),this.auth.onAuthStateChanged(this.onAuthStateChanged.bind(this))},ZiCuSoare.prototype.signInFacebook=function(){var t=new firebase.auth.FacebookAuthProvider;this.auth.signInWithPopup(t)},ZiCuSoare.prototype.signInGoogle=function(){var t=new firebase.auth.GoogleAuthProvider;this.auth.signInWithPopup(t)},ZiCuSoare.prototype.signInTwitter=function(){var t=new firebase.auth.TwitterAuthProvider;this.auth.signInWithPopup(t)},ZiCuSoare.prototype.checkSignedIn=function(){return!!this.auth.currentUser},ZiCuSoare.prototype.signOut=function(){this.auth.signOut()},ZiCuSoare.prototype.onAuthStateChanged=function(t){t?this.showAuthStatusLogged(t.displayName,t.photoURL):this.showAuthStatusAnon()},ZiCuSoare.prototype.listReactions=function(t){t.val()[this.addr]&&(this.reactions=t.val()[this.addr],$("#total-reactions").trigger("reaction-change",this.reactions),this.readMyReaction())},ZiCuSoare.prototype.readMyReaction=function(){if(this.checkSignedIn()&&this.reactions){var t=this.auth.currentUser.uid,e=this.reactions[t];e&&e.reaction&&$("#my-reaction").trigger("reaction-change",e.reaction)}},ZiCuSoare.prototype.sendReaction=function(t){var e=this.auth.currentUser.uid;console.log("Trimis reactia:",t),this.re_db.child(this.addr).child(e).set({name:this.auth.currentUser.displayName,reaction:t,postedAt:Date.now()})},ZiCuSoare.prototype.showAuthStatusLogged=function(t,e){console.log("Autentificat:",t,e),this.readMyReaction();var i=this.auth.currentUser,o=i.providerData[0].providerId.replace(".com","");$("#my-reaction").trigger("sign-in",{p:o,u:t})},ZiCuSoare.prototype.showAuthStatusAnon=function(){console.log("Ne-autentificat!"),$("#my-reaction").trigger("sign-out")},$(function(){window.z=new ZiCuSoare;var t=window.z;$("#total-reactions").on("reaction-change",function(t,e){console.log("Total reactii:",Object.keys(e).length);var i=0,o=0;for(var n in e)"love"===e[n].reaction?i++:"hate"===e[n].reaction&&o++;$("#love-reactions").text(i),$("#hate-reactions").text(o)}),$("#my-reaction").on("reaction-change",function(t,e){console.log("Reactia mea:",e),"love"===e?($("#send-love").addClass("red"),$("#send-hate").removeClass("brown")):"hate"===e&&($("#send-hate").addClass("brown"),$("#send-love").removeClass("red"))}),$("#my-reaction").on("sign-in",function(t,e){$("#prov-id").addClass(e.p),$("#user-name").text(e.u),$("#post-auth-ok").removeClass("hidden"),$("#post-auth-req").addClass("hidden")}),$("#my-reaction").on("sign-out",function(){$("#send-love").removeClass("red"),$("#send-hate").removeClass("brown"),$("#post-auth-ok").addClass("hidden"),$("#post-auth-req").removeClass("hidden"),$("#prov-id").removeClass("facebook").removeClass("google").removeClass("twitter")}),$("#post-auth-req .facebook.login.icon").click(function(){t.signInFacebook()}),$("#post-auth-req .google.login.icon").click(function(){t.signInGoogle()}),$("#post-auth-req .twitter.login.icon").click(function(){t.signInTwitter()}),$("#post-sign-out").click(function(){t.signOut()});var e='Trebuie să fii autentificat ca să-ți poți trimite reacția.<br />Durează doar o secundă și nu doare! Promit <i class="icon smile"></i>',i='Mă bucur că ți-a plăcut articolul <i class="icon smile"></i>',o='Îmi pare nespus de rău că nu ți-a plăcut <i class="icon frown"></i>';new jBox("Tooltip",{fade:500,trigger:"click",autoClose:2500,attach:"#send-love",onOpen:function(){t.checkSignedIn()?this.setContent(i):this.setContent(e)}}),new jBox("Tooltip",{fade:500,trigger:"click",autoClose:2500,attach:"#send-hate",onOpen:function(){t.checkSignedIn()?this.setContent(o):this.setContent(e)}});$("#send-love").click(function(){t.checkSignedIn()?t.sendReaction("love"):shake("#post-auth-req")}),$("#send-hate").click(function(){t.checkSignedIn()?t.sendReaction("hate"):shake("#post-auth-req")})});